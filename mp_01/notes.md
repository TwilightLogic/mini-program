# Leaning mini-program

## 代码结构

### JSON配置文件

#### app.json 

是当前小程序的全局配置，包括了小程序的所有**页面路径、窗口外观、界面表现、底部tab**等。

- pages: 用来记录当前小程序所有页面的路径
- window: 用来定义小程序所有页面的背景色、文字颜色等
- style: ：全局定义小程序组件所使用的样式版本
- sitemapLocation：用来指明sitemap.json的位置

#### sitemap.json

微信现已开放小程序内搜索，效果类似于PC网页的SEO。sitemapjson文件用来配置小程序页面是**否允许微信索引**

如果`index.json`和`app.json`的配置冲突，则会以`index.json`的配置为准

#### 新增小程序页面

只需要在 `app.json-＞pages` 中新增页面的存放路径，小程序开发者工具即可帮我们自动创建对应的页面文件

#### 修改项目首页

只需要调整 `app.json-＞pages` 数组中页面路径的前后顺序，即可修改项目的首页。小程序会把排在第一位的页
面，当作项目首页进行渲染

### WXML模版

WXML(weixinMarkupLanguage)是小程序框架设计的一套标签语言，用来构建小程序页面的结构，其作
用类似于网页开发中的HTML。

#### 与HTML的区别
1. 标签名称不同
- HTML (div, span, img, a)
- WXML (view, text, image, navigator)

2. 属性节点不同
- `<a href="#">超链接</a>`
- `<navigator url="/pages/home/home"></navigator>`

3. 提供了类似子Vue中的模板语法
- 数据绑定
- 列表渲染
- 条件渲染

### WXSS样式

#### 与CSS的区别

1. 新增了rpx尺寸单位
- CSS中需要手动进行像素单位换算，例如rem
- wxss在底层支持新的尺寸单位rpx，在不同大小的屏幕上小程序会自动进行换算

2. 提供了全局的样式和局部样式
- 项目根目录中的`app.wxss`会作用于所有小程序页面
- 局部页面的`.wxss`样式仅对当前页面生效

3. WXSS仅支持部分的CSS选择器

### js

小程序中的JS文件分为三大类，分别是：
1. app.js
- 是整个小程序项目的入口文件，通过调用App()函数来启动整个小程序
2. 页面的.js文件
- 是页面的入口文件，通过调用Page()函数来创建并运行页面
3. 普通的.js文件
- 是普通的功能模块文件，用来封装公共的函数或属性供页面使用

## 宿主环境

小程序的宿主环境就是**手机微信**

小程序宿主环境包含的内容

1. 通信模型
2. 运行机制
3. 组件
4. API

### 通信模型

#### 1. 通信的主体

小程序中通信的主体是渲染层和逻辑层，其中：
- WXML模板和WXSS样式工作在渲染层
- JS脚本工作在逻辑层

#### 2. 小程序的通信模型

分为两部分（都是由微信客户端进行转发）：
- 渲染层和逻辑层之间的通信
- 逻辑层和第三方服务器之间的通信

### 运行机制

1. 把小程序的代码包下载到本地
2. 解析app.json全局配置文件
3. 执行app.js小程序入口文件，调用`App()`创建小程序实例
4. 渲染小程序首页
5. 小程序启动完成

## 组件

### 1.小程序中组件的分类 

小程序中的组件也是由宿主环境提供的，开发者可以基于组件快速搭建出漂亮的页面结构。官方把小程序的组
件分为了9大类，分别是：

1. 视图容器
2. 基础肉容
3. 表单组件
4. 导航组件
5. 媒体组件
6. map地图组件
7. canvas画布组件
8. 开放能力
9. 无障碍访问

### 2.常用的视图容器类组件

1. `view`
- 普通视图区域
- 类似于HTML中的`<div>`，是一个块级元素
- 常用来实现页面的布局效果

2. `scroll-view`
- 可滚动的视图区域
- 常用来实现滚动列表效果

3. `swiper`, `swiper-iter`
- 轮播图容器组件和轮播图item组件

#### swiper 组件的常用属性

> `indicator-dots`: 是否显示面板指示点
> `indicator-color`: 指示点颜色
> `indicator-active-color`: 当前选中的指示点颜色
> `autoplay`: 是否自动切换
> `interval`: 自动切换时间间隔
> `circular`: 是否采用衔接滑动

### 常用的基础内容组件

1. `text`
- 文本组件
- 类似于HTML里的`<span>`，是一个行内元素

2. `rich-text`
- 富文本组件
- 支持把HTML字符串渲染为WXML结构

#### `text`组件的基本使用

1. 通过 `text` 组件的 `selectable` 属性，实现长按选中文本内容的效果（只有`text`支持长按选中）

2. 通过`rich-text`组件的nodes属性节点，把HTML字符串渲染为对应的UI结构：

```html
  <rich-text nodes="h1 style='color:red;'">标题</rich-text>
```